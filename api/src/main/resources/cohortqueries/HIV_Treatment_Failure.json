{
  "name": "HIV Treatment Failure",
  "description": "HIV patients who have reported treatment failure or have viral load > 5000",
  "interval": "7 days",
  "mappings": [
    "CIEL_1252", /* REASON ANTIRETROVIRALS STOPPED */
    "CIEL_843",  /* Regimen failure */
    "CIEL_856"   /* HIV VIRAL LOAD */
  ],
  "sql": "
SELECT person_id
FROM obs
WHERE
  UNIX_TIMESTAMP(obs_datetime) > :lastExecutionTime
  AND
  ((concept_id = :CIEL_1252
   AND value_coded = :CIEL_843)
  OR
  (concept_id = :CIEL_856
   AND value_numeric > 5000))
  AND not voided;
"
}